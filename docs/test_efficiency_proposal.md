# Flutter ãƒ†ã‚¹ãƒˆåŠ¹ç‡åŒ–ã®ææ¡ˆ

## ğŸ¯ åŠ¹ç‡åŒ–æˆ¦ç•¥

### 1. **ãƒ–ãƒ©ãƒ³ãƒãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆæˆ¦ç•¥**

| ãƒ–ãƒ©ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ | ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ | å®Ÿè¡Œæ™‚é–“ | ã‚«ãƒãƒ¬ãƒƒã‚¸ | èª¬æ˜ |
|----------------|-----------|----------|-----------|------|
| `main` | Full | ~15åˆ† | å¿…é ˆ | æœ¬ç•ªãƒªãƒªãƒ¼ã‚¹å‰ã®å®Œå…¨ãƒ†ã‚¹ãƒˆ |
| `development` | Comprehensive | ~12åˆ† | æ¨å¥¨ | UIä»¥å¤–ã®å…¨æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ |
| `feature/*` | Targeted | ~5åˆ† | å¤‰æ›´éƒ¨åˆ†ã®ã¿ | å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã«é–¢é€£ã™ã‚‹ãƒ†ã‚¹ãƒˆã®ã¿ |
| `hotfix/*` | Critical | ~2åˆ† | ãªã— | æœ€é‡è¦ãƒ†ã‚¹ãƒˆã®ã¿ |
| `bug/*` | Targeted | ~5åˆ† | å¤‰æ›´éƒ¨åˆ†ã®ã¿ | ãƒã‚°ä¿®æ­£ã«é–¢é€£ã™ã‚‹ãƒ†ã‚¹ãƒˆã®ã¿ |
| ãã®ä»– | Standard | ~8åˆ† | åŸºæœ¬ | ã‚³ã‚¢ãƒ­ã‚¸ãƒƒã‚¯ã®ãƒ†ã‚¹ãƒˆ |

### 2. **å®Ÿè£…ã•ã‚ŒãŸãƒ„ãƒ¼ãƒ«**

#### ğŸ”§ æœ€é©åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ (`scripts/optimize_tests.sh`)
```bash
# è‡ªå‹•ã§ãƒ–ãƒ©ãƒ³ãƒã‚’æ¤œå‡ºã—ã¦ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã‚’æ±ºå®š
./scripts/optimize_tests.sh

# æ‰‹å‹•ã§ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã‚’æŒ‡å®š
./scripts/optimize_tests.sh feature/auth main targeted

# ç‰¹å®šã®ãƒ–ãƒ©ãƒ³ãƒã§ãƒ†ã‚¹ãƒˆ
./scripts/optimize_tests.sh development main comprehensive
```

#### ğŸ“Š GitHubãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ (`flutter_test_optimized.yml`)
- å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«æ¤œå‡ºã«ã‚ˆã‚‹æ¡ä»¶ä»˜ãå®Ÿè¡Œ
- ãƒ–ãƒ©ãƒ³ãƒåˆ¥ã®ä¸¦åˆ—ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- æ—©æœŸå¤±æ•—ã«ã‚ˆã‚‹ãƒªã‚½ãƒ¼ã‚¹ç¯€ç´„
- è©³ç´°ãªãƒ†ã‚¹ãƒˆçµæœãƒ¬ãƒãƒ¼ãƒˆ

### 3. **ãƒ†ã‚¹ãƒˆã‚«ãƒ†ã‚´ãƒªåˆ†é¡**

#### ğŸš¨ Critical Tests (2åˆ†)
```bash
# æœ€é‡è¦ãªãƒ†ã‚¹ãƒˆã®ã¿
flutter test test/models/ test/utils/ --reporter=compact
```
- **å¯¾è±¡**: ãƒ¢ãƒ‡ãƒ«ã€åŸºæœ¬ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
- **å®Ÿè¡Œ**: å…¨ãƒ–ãƒ©ãƒ³ãƒã§å¿…é ˆ
- **ç›®çš„**: åŸºæœ¬æ©Ÿèƒ½ã®ç ´ç¶»ãƒã‚§ãƒƒã‚¯

#### ğŸ¯ Targeted Tests (5åˆ†)
```bash
# å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã«é–¢é€£ã™ã‚‹ãƒ†ã‚¹ãƒˆã®ã¿
if [ -d "test/models/" ] && [[ $models_changed == true ]]; then
  flutter test test/models/
fi
```
- **å¯¾è±¡**: å¤‰æ›´ã•ã‚ŒãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ†ã‚¹ãƒˆ
- **å®Ÿè¡Œ**: feature/, bug/ ãƒ–ãƒ©ãƒ³ãƒ
- **ç›®çš„**: å¤‰æ›´ã«ã‚ˆã‚‹å½±éŸ¿ç¯„å›²ã®ç¢ºèª

#### ğŸ“‹ Standard Tests (8åˆ†)
```bash
# ã‚³ã‚¢ãƒ­ã‚¸ãƒƒã‚¯ã®ãƒ†ã‚¹ãƒˆ
flutter test test/models/ test/services/ test/providers/ --reporter=expanded
```
- **å¯¾è±¡**: ãƒ¢ãƒ‡ãƒ«ã€ã‚µãƒ¼ãƒ“ã‚¹ã€ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼
- **å®Ÿè¡Œ**: é€šå¸¸ã®ãƒ–ãƒ©ãƒ³ãƒ
- **ç›®çš„**: ä¸»è¦æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª

#### ğŸ” Comprehensive Tests (12åˆ†)
```bash
# UIä»¥å¤–ã®å…¨ãƒ†ã‚¹ãƒˆ + ã‚«ãƒãƒ¬ãƒƒã‚¸
flutter test --exclude-tags=widget --coverage --reporter=expanded
```
- **å¯¾è±¡**: ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆä»¥å¤–ã®å…¨ãƒ†ã‚¹ãƒˆ
- **å®Ÿè¡Œ**: development ãƒ–ãƒ©ãƒ³ãƒ
- **ç›®çš„**: çµ±åˆå‰ã®åŒ…æ‹¬çš„ãƒã‚§ãƒƒã‚¯

#### ğŸ¯ Full Tests (15åˆ†)
```bash
# å…¨ãƒ†ã‚¹ãƒˆ + ã‚«ãƒãƒ¬ãƒƒã‚¸ + è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆ
flutter test --coverage --reporter=expanded
```
- **å¯¾è±¡**: å…¨ãƒ†ã‚¹ãƒˆ
- **å®Ÿè¡Œ**: main ãƒ–ãƒ©ãƒ³ãƒ
- **ç›®çš„**: ãƒªãƒªãƒ¼ã‚¹å‰ã®å®Œå…¨æ¤œè¨¼

### 4. **å®Ÿè£…æ¸ˆã¿æœ€é©åŒ–**

#### âœ… å¤‰æ›´æ¤œå‡ºæ©Ÿèƒ½
```bash
# Gitå·®åˆ†ã«ã‚ˆã‚‹å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«æ¤œå‡º
get_changed_files() {
    if git rev-parse --verify HEAD^ >/dev/null 2>&1; then
        git diff --name-only HEAD^ HEAD
    else
        git ls-files | head -10
    fi
}
```

#### âœ… æ¡ä»¶ä»˜ããƒ†ã‚¹ãƒˆå®Ÿè¡Œ
```bash
# å¤‰æ›´ãŒã‚ã£ãŸå ´åˆã®ã¿ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
if [[ $models_changed == true ]]; then
    flutter test test/models/
fi
```

#### âœ… ã‚«ãƒãƒ¬ãƒƒã‚¸åˆ†æ
```bash
# ã‚«ãƒãƒ¬ãƒƒã‚¸çµ±è¨ˆã®è‡ªå‹•è¡¨ç¤º
show_coverage_stats() {
    # Python3ã§LCOVãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£æ
    # ä½ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ•ã‚¡ã‚¤ãƒ«ã®ç‰¹å®š
    # æœªã‚«ãƒãƒ¼è¡Œã®è©³ç´°è¡¨ç¤º
}
```

### 5. **ä½¿ç”¨æ–¹æ³•**

#### ğŸš€ é–‹ç™ºè€…å‘ã‘
```bash
# ç¾åœ¨ã®ãƒ–ãƒ©ãƒ³ãƒã«å¿œã˜ãŸæœ€é©ãªãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
./scripts/optimize_tests.sh

# ãƒ•ãƒ«ãƒ†ã‚¹ãƒˆã‚’å¼·åˆ¶å®Ÿè¡Œ
./scripts/optimize_tests.sh $(git rev-parse --abbrev-ref HEAD) main full

# ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãƒ†ã‚¹ãƒˆã®ã¿å®Ÿè¡Œ
./scripts/optimize_tests.sh $(git rev-parse --abbrev-ref HEAD) main critical
```

#### ğŸ”§ CI/CDå‘ã‘
```yaml
# .github/workflows/flutter_test_optimized.yml ã‚’ä½¿ç”¨
# è‡ªå‹•ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œ:
# 1. å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«æ¤œå‡º
# 2. ãƒ–ãƒ©ãƒ³ãƒã«å¿œã˜ãŸãƒ†ã‚¹ãƒˆæˆ¦ç•¥æ±ºå®š
# 3. ä¸¦åˆ—ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
# 4. çµæœãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
```

### 6. **æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ**

#### â±ï¸ å®Ÿè¡Œæ™‚é–“çŸ­ç¸®
- **feature ãƒ–ãƒ©ãƒ³ãƒ**: 15åˆ† â†’ 5åˆ† (67%çŸ­ç¸®)
- **bug ãƒ–ãƒ©ãƒ³ãƒ**: 15åˆ† â†’ 5åˆ† (67%çŸ­ç¸®)
- **hotfix ãƒ–ãƒ©ãƒ³ãƒ**: 15åˆ† â†’ 2åˆ† (87%çŸ­ç¸®)

#### ğŸ’° ãƒªã‚½ãƒ¼ã‚¹ç¯€ç´„
- **CIåˆ†æ•°å‰Šæ¸›**: æœˆé–“ã§å¤§å¹…ãªã‚³ã‚¹ãƒˆå‰Šæ¸›
- **é–‹ç™ºè€…å¾…æ©Ÿæ™‚é–“çŸ­ç¸®**: ç”Ÿç”£æ€§å‘ä¸Š
- **æ—©æœŸãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**: å•é¡Œã®æ—©æœŸç™ºè¦‹

#### ğŸ¯ å“è³ªç¶­æŒ
- **main ãƒ–ãƒ©ãƒ³ãƒ**: 100%ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- **critical ãƒ†ã‚¹ãƒˆ**: å¸¸æ™‚å®Ÿè¡Œã§åŸºæœ¬å“è³ªä¿è¨¼
- **æ®µéšçš„ãƒã‚§ãƒƒã‚¯**: ãƒ–ãƒ©ãƒ³ãƒã”ã¨ã®é©åˆ‡ãªå“è³ªã‚²ãƒ¼ãƒˆ

### 7. **ã•ã‚‰ãªã‚‹æœ€é©åŒ–æ¡ˆ**

#### ğŸ”„ ä¸¦åˆ—å®Ÿè¡Œ
```yaml
strategy:
  matrix:
    test-category: [models, providers, services, repositories]
```

#### ğŸ“Š ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ´»ç”¨
```yaml
- name: ã‚­ãƒ£ãƒƒã‚·ãƒ¥å¾©å…ƒ
  uses: actions/cache@v3
  with:
    path: |
      ~/.pub-cache
      build/
    key: flutter-${{ hashFiles('pubspec.lock') }}
```

#### ğŸ¯ å·®åˆ†ãƒ†ã‚¹ãƒˆ
```bash
# å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã«é–¢é€£ã™ã‚‹ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿å®Ÿè¡Œ
find_related_tests() {
    local changed_file=$1
    case $changed_file in
        lib/models/*) echo "test/models/" ;;
        lib/services/*) echo "test/services/" ;;
        lib/providers/*) echo "test/providers/" ;;
    esac
}
```

### 8. **å°å…¥æ‰‹é †**

1. **ã‚¹ã‚¯ãƒªãƒ—ãƒˆé…ç½®**: `scripts/optimize_tests.sh` ã‚’å®Ÿè¡Œå¯èƒ½ã«ã™ã‚‹
2. **ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ›´æ–°**: `.github/workflows/flutter_test_optimized.yml` ã‚’æœ‰åŠ¹åŒ–
3. **è¨­å®šèª¿æ•´**: `dart_test.yaml` ã§ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆç­‰ã‚’èª¿æ•´
4. **ãƒãƒ¼ãƒ å‘¨çŸ¥**: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå…±æœ‰ã¨ä½¿ç”¨æ–¹æ³•èª¬æ˜

ã“ã®åŠ¹ç‡åŒ–ã«ã‚ˆã‚Šã€é–‹ç™ºé€Ÿåº¦ã®å‘ä¸Šã¨å“è³ªç¶­æŒã‚’ä¸¡ç«‹ã§ãã¾ã™ã€‚
